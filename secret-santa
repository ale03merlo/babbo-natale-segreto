import random

def babbo_natale_segreto(partecipanti, coppie, abbinamenti_precedenti):
    destinatari = partecipanti[:]
    abbinamenti = {}

    for donatore in partecipanti:
        # Filtra i destinatari per rispettare i vincoli
        possibili_destinatari = [
            d for d in destinatari
            if d != donatore
            and (donatore, d) not in coppie
            and (d, donatore) not in coppie
            and (donatore, d) not in abbinamenti_precedenti
        ]

        if not possibili_destinatari:
            print("‚ùå Errore: Non √® possibile creare abbinamenti rispettando i vincoli.")
            return None

        # Scegli un destinatario casuale
        destinatario = random.choice(possibili_destinatari)
        abbinamenti[donatore] = destinatario
        destinatari.remove(destinatario)

    return abbinamenti


# Partecipanti
partecipanti = [
    "Ale", "Pier", "Arianna", "Vittorio", "Federico", "Riccardo",
    "Barbara", "Roberta", "Ilaria", "Mattia", "Filippo",
    "Francesca", "Marco", "Giorgio", "Matteo"
]

# Coppie che non possono scambiarsi regali
coppie = [("Ale", "Pier"), ("Arianna", "Vittorio"), ("Ilaria", "Mattia")]

# Abbinamenti gi√† avvenuti
abbinamenti_precedenti = [
    ("Francesca", "Barbara"), ("Barbara", "Pier"), ("Pier", "Ilaria"),
    ("Ilaria", "Matteo"), ("Matteo", "Mattia"), ("Mattia", "Arianna"),
    ("Arianna", "Giorgio"), ("Riccardo", "Marco"), ("Vittorio", "Pier"),
    ("Pier", "Marco"), ("Marco", "Filippo"), ("Filippo", "Mattia"),
    ("Mattia", "Matteo"), ("Matteo", "Ale"), ("Ale", "Ilaria"),
    ("Ilaria", "Arianna"), ("Arianna", "Barbara"), ("Barbara", "Roberta"),
    ("Roberta", "Federico"), ("Federico", "Giorgio"), ("Giorgio", "Riccardo"),
    ("Riccardo", "Francesca"), ("Francesca", "Vittorio"), ("Barbara", "Matteo"),
    ("Matteo", "Barbara"), ("Barbara", "Marco"), ("Marco", "Barbara")
]

# Crea gli abbinamenti
risultati = babbo_natale_segreto(partecipanti, coppie, abbinamenti_precedenti)

# Funzione per scoprire il destinatario segreto
def scopri_destinatario(nome):
    if risultati:
        destinatario = risultati.get(nome)
        if destinatario:
            print("\n‚≠êHEYLA‚≠ê")
            print(f"üéÖ {nome:<10} il tuo Babbo Segreto sar√† üéÅ {destinatario}!")
            print("‚≠ê" * 20)
            print("üéÑ Buon divertimento e STUPENDO Natale! üéÑ")
        else:
            print("‚ùå Nome non valido. Assicurati di inserire correttamente il tuo nome.")
    else:
        print("‚ùå Gli abbinamenti non sono stati generati correttamente.")

# Richiedi il nome del partecipante
print("\nüéÅ Benvenuto al Babbo Natale Segreto 2024! üéÅ")
nome = input("Inserisci il tuo nome per scoprire il destinatario: ").strip()
scopri_destinatario(nome)
